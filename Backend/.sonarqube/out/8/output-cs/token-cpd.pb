˚∆
WC:\Users\hienv\OneDrive\Desktop\NVHIEN\DoAnTotNghiep\Backend\PostgresDBData\BaseRepo.cs
	namespace 	
PostgresDBData
 
{ 
public 

class 
BaseRepo 
< 
TEntity !
>! "
:# $
	IBaseRepo% .
<. /
TEntity/ 6
>6 7
where8 =
TEntity> E
:F G
classH M
{ 
	protected 
readonly 
PostgreSqlContext ,
_context- 5
;5 6
public 
DbSet 
< 
TEntity 
> 
entities &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
BaseRepo 
( 
) 
{ 	
var 
contextOptions 
=  
new! $#
DbContextOptionsBuilder% <
<< =
PostgreSqlContext= N
>N O
(O P
)P Q
. 
	UseNpgsql 
( 
@$" 
{ 
PostgresSettings /
./ 0
ConnectionString0 @
}@ A
"A B
)B C
. 
Options 
; 
_context 
= 
new 
PostgreSqlContext ,
(, -
contextOptions- ;
); <
;< =
} 	
public 
async 
Task 
< 
bool 
> 
DeleteManyAsync  /
(/ 0
IEnumerable0 ;
<; <
TEntity< C
>C D
entitiesE M
)M N
{ 	
await 
Task 
. 
CompletedTask $
;$ %
if 
( 
entities 
== 
null  
||! #
entities$ ,
., -
Count- 2
(2 3
)3 4
<=5 7
$num8 9
)9 :
return; A
falseB G
;G H
try 
{ 
_context 
. 
RemoveRange $
($ %
entities% -
)- .
;. /
await   
_context   
.   
SaveChangesAsync   /
(  / 0
true  0 4
)  4 5
;  5 6
return!! 
true!! 
;!! 
}"" 
catch## 
(## 
	Exception## 
)## 
{$$ 
return%% 
false%% 
;%% 
}&& 
}'' 	
public)) 
async)) 
Task)) 
<)) 
bool)) 
>)) 
DeleteManyAsync))  /
())/ 0
IEnumerable))0 ;
<)); <
string))< B
>))B C
ids))D G
)))G H
{** 	
if++ 
(++ 
ids++ 
==++ 
null++ 
||++ 
ids++ "
.++" #
Count++# (
(++( )
)++) *
<=+++ -
$num++. /
)++/ 0
return++1 7
false++8 =
;++= >
var,, 
entities,, 
=,, 
await,,  
GetByIdsAsync,,! .
(,,. /
ids,,/ 2
),,2 3
;,,3 4
if-- 
(-- 
entities-- 
==-- 
null--  
||--! #
entities--$ ,
.--, -
Count--- 2
(--2 3
)--3 4
<=--5 7
$num--8 9
)--9 :
return--; A
false--B G
;--G H
try.. 
{// 
_context00 
.00 
RemoveRange00 $
(00$ %
entities00% -
)00- .
;00. /
await11 
_context11 
.11 
SaveChangesAsync11 /
(11/ 0
true110 4
)114 5
;115 6
return22 
true22 
;22 
}33 
catch44 
(44 
	Exception44 
)44 
{55 
return66 
false66 
;66 
}77 
}88 	
public:: 
async:: 
Task:: 
<:: 
bool:: 
>:: 
DeleteManyAsync::  /
(::/ 0
Func::0 4
<::4 5
TEntity::5 <
,::< =
bool::> B
>::B C
	predicate::D M
)::M N
{;; 	
var<< 
entities<< 
=<< 
await<<  
GetAllAsync<<! ,
(<<, -
	predicate<<- 6
)<<6 7
;<<7 8
if== 
(== 
entities== 
==== 
null==  
||==! #
entities==$ ,
.==, -
Count==- 2
(==2 3
)==3 4
<===5 7
$num==8 9
)==9 :
return==; A
false==B G
;==G H
try>> 
{?? 
_context@@ 
.@@ 
RemoveRange@@ $
(@@$ %
entities@@% -
)@@- .
;@@. /
awaitAA 
_contextAA 
.AA 
SaveChangesAsyncAA /
(AA/ 0
trueAA0 4
)AA4 5
;AA5 6
returnBB 
trueBB 
;BB 
}CC 
catchDD 
(DD 
	ExceptionDD 
)DD 
{EE 
returnFF 
falseFF 
;FF 
}GG 
}HH 	
publicJJ 
asyncJJ 
TaskJJ 
<JJ 
boolJJ 
>JJ 
DeleteOneAsyncJJ  .
(JJ. /
TEntityJJ/ 6
entityJJ7 =
)JJ= >
{KK 	
awaitLL 
TaskLL 
.LL 
CompletedTaskLL $
;LL$ %
ifMM 
(MM 
entityMM 
==MM 
nullMM 
)MM 
returnMM  &
falseMM' ,
;MM, -
varNN 
resNN 
=NN 
_contextNN 
.NN 
RemoveNN %
<NN% &
TEntityNN& -
>NN- .
(NN. /
entityNN/ 5
)NN5 6
;NN6 7
awaitOO 
_contextOO 
.OO 
SaveChangesAsyncOO +
(OO+ ,
trueOO, 0
)OO0 1
;OO1 2
returnPP 
resPP 
!=PP 
nullPP 
;PP 
}QQ 	
publicSS 
asyncSS 
TaskSS 
<SS 
boolSS 
>SS 
DeleteOneAsyncSS  .
(SS. /
FuncSS/ 3
<SS3 4
TEntitySS4 ;
,SS; <
boolSS= A
>SSA B
	predicateSSC L
)SSL M
{TT 	
awaitUU 
TaskUU 
.UU 
CompletedTaskUU $
;UU$ %
varVV 
entityVV 
=VV 
awaitVV 
GetOneAsyncVV *
(VV* +
	predicateVV+ 4
)VV4 5
;VV5 6
ifWW 
(WW 
entityWW 
==WW 
nullWW 
)WW 
returnWW  &
falseWW' ,
;WW, -
varXX 
resXX 
=XX 
_contextXX 
.XX 
RemoveXX %
<XX% &
TEntityXX& -
>XX- .
(XX. /
entityXX/ 5
)XX5 6
;XX6 7
awaitYY 
_contextYY 
.YY 
SaveChangesAsyncYY +
(YY+ ,
trueYY, 0
)YY0 1
;YY1 2
returnZZ 
resZZ 
!=ZZ 
nullZZ 
;ZZ 
}[[ 	
public]] 
async]] 
Task]] 
<]] 
bool]] 
>]] 
DeleteOneAsync]]  .
(]]. /
string]]/ 5
id]]6 8
)]]8 9
{^^ 	
if__ 
(__ 
string__ 
.__ 
IsNullOrEmpty__ $
(__$ %
id__% '
)__' (
)__( )
return__* 0
false__1 6
;__6 7
var`` 
entity`` 
=`` 
await`` 
_context`` '
.``' (
Set``( +
<``+ ,
TEntity``, 3
>``3 4
(``4 5
)``5 6
.``6 7
	FindAsync``7 @
(``@ A
id``A C
)``C D
;``D E
ifaa 
(aa 
entityaa 
==aa 
nullaa 
)aa 
returnaa  &
falseaa' ,
;aa, -
varbb 
resbb 
=bb 
_contextbb 
.bb 
Removebb %
<bb% &
TEntitybb& -
>bb- .
(bb. /
entitybb/ 5
)bb5 6
;bb6 7
awaitcc 
_contextcc 
.cc 
SaveChangesAsynccc +
(cc+ ,
truecc, 0
)cc0 1
;cc1 2
returndd 
resdd 
!=dd 
nulldd 
;dd 
}ee 	
publicgg 
IEnumerablegg 
<gg 
TEntitygg "
>gg" #
GetAllgg$ *
(gg* +
)gg+ ,
{hh 	
varii 
entitiesii 
=ii 
_contextii #
.ii# $
Setii$ '
<ii' (
TEntityii( /
>ii/ 0
(ii0 1
)ii1 2
.ii2 3
ToListii3 9
(ii9 :
)ii: ;
;ii; <
returnjj 
entitiesjj 
;jj 
}kk 	
publicmm 
asyncmm 
Taskmm 
<mm 
IEnumerablemm %
<mm% &
TEntitymm& -
>mm- .
>mm. /
GetAllAsyncmm0 ;
(mm; <
)mm< =
{nn 	
varoo 
entitiesoo 
=oo 
awaitoo  
_contextoo! )
.oo) *
Setoo* -
<oo- .
TEntityoo. 5
>oo5 6
(oo6 7
)oo7 8
.oo8 9
ToListAsyncoo9 D
(ooD E
)ooE F
;ooF G
returnpp 
entitiespp 
;pp 
}qq 	
publicrr 
asyncrr 
Taskrr 
<rr 
IEnumerablerr %
<rr% &
TEntityrr& -
>rr- .
>rr. /
GetByIdsAsyncrr0 =
(rr= >
IEnumerablerr> I
<rrI J
stringrrJ P
>rrP Q
idsrrR U
)rrU V
{ss 	
vartt 
entitiestt 
=tt 
awaittt  
_contexttt! )
.tt) *
Settt* -
<tt- .
TEntitytt. 5
>tt5 6
(tt6 7
)tt7 8
.tt8 9
ToListAsynctt9 D
(ttD E
)ttE F
;ttF G
entitiesuu 
=uu 
entitiesuu 
.uu  
Whereuu  %
(uu% &
euu& '
=>uu( *
idsuu+ .
.uu. /
Anyuu/ 2
(uu2 3
xuu3 4
=>uu5 7
xuu8 9
.uu9 :
ToStringuu: B
(uuB C
)uuC D
.uuD E
EqualsuuE K
(uuK L
euuL M
.uuM N
ToStringuuN V
(uuV W
)uuW X
)uuX Y
)uuY Z
)uuZ [
.uu[ \
ToListuu\ b
(uub c
)uuc d
;uud e
returnvv 
entitiesvv 
;vv 
}ww 	
publicyy 
TEntityyy 
GetByIdyy 
(yy 
stringyy %
idyy& (
)yy( )
{zz 	
return{{ 
_context{{ 
.{{ 
Set{{ 
<{{  
TEntity{{  '
>{{' (
({{( )
){{) *
.{{* +
Find{{+ /
({{/ 0
id{{0 2
){{2 3
;{{3 4
}|| 	
public~~ 
async~~ 
Task~~ 
<~~ 
TEntity~~ !
>~~! "
GetByIdAsync~~# /
(~~/ 0
string~~0 6
id~~7 9
)~~9 :
{ 	
var
ÄÄ 
entity
ÄÄ 
=
ÄÄ 
await
ÄÄ 
_context
ÄÄ '
.
ÄÄ' (
Set
ÄÄ( +
<
ÄÄ+ ,
TEntity
ÄÄ, 3
>
ÄÄ3 4
(
ÄÄ4 5
)
ÄÄ5 6
.
ÄÄ6 7
	FindAsync
ÄÄ7 @
(
ÄÄ@ A
id
ÄÄA C
)
ÄÄC D
;
ÄÄD E
return
ÅÅ 
entity
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
public
ÑÑ 
async
ÑÑ 
Task
ÑÑ 
<
ÑÑ 
IEnumerable
ÑÑ %
<
ÑÑ% &
TEntity
ÑÑ& -
>
ÑÑ- .
>
ÑÑ. /
InsertManyAsync
ÑÑ0 ?
(
ÑÑ? @
IEnumerable
ÑÑ@ K
<
ÑÑK L
TEntity
ÑÑL S
>
ÑÑS T
entities
ÑÑU ]
)
ÑÑ] ^
{
ÖÖ 	
try
ÜÜ 
{
áá 
await
àà 
_context
àà 
.
àà 
AddRangeAsync
àà ,
(
àà, -
entities
àà- 5
)
àà5 6
;
àà6 7
await
ââ 
_context
ââ 
.
ââ 
SaveChangesAsync
ââ /
(
ââ/ 0
true
ââ0 4
)
ââ4 5
;
ââ5 6
return
ää 
entities
ää 
;
ää  
}
ãã 
catch
åå 
(
åå 
	Exception
åå 
ex
åå 
)
åå  
{
çç 
return
éé 
null
éé 
;
éé 
}
èè 
}
êê 	
public
íí 
async
íí 
Task
íí 
<
íí 
TEntity
íí !
>
íí! "
InsertOneAsync
íí# 1
(
íí1 2
TEntity
íí2 9
entity
íí: @
)
íí@ A
{
ìì 	
try
îî 
{
ïï 
await
ññ 
_context
ññ 
.
ññ 
AddAsync
ññ '
(
ññ' (
entity
ññ( .
)
ññ. /
;
ññ/ 0
await
óó 
_context
óó 
.
óó 
SaveChangesAsync
óó /
(
óó/ 0
true
óó0 4
)
óó4 5
;
óó5 6
return
òò 
entity
òò 
;
òò 
}
ôô 
catch
öö 
(
öö 
	Exception
öö 
ex
öö 
)
öö  
{
õõ 
return
úú 
null
úú 
;
úú 
}
ùù 
}
ûû 	
public
†† 
async
†† 
Task
†† 
<
†† 
bool
†† 
>
†† 
UpdateManyAsync
††  /
(
††/ 0
IEnumerable
††0 ;
<
††; <
TEntity
††< C
>
††C D
entities
††E M
)
††M N
{
°° 	
await
¢¢ 
Task
¢¢ 
.
¢¢ 
CompletedTask
¢¢ $
;
¢¢$ %
try
££ 
{
§§ 
_context
•• 
.
•• 
UpdateRange
•• $
(
••$ %
entities
••% -
)
••- .
;
••. /
await
¶¶ 
_context
¶¶ 
.
¶¶ 
SaveChangesAsync
¶¶ /
(
¶¶/ 0
true
¶¶0 4
)
¶¶4 5
;
¶¶5 6
return
ßß 
true
ßß 
;
ßß 
}
®® 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
™™ 
return
´´ 
false
´´ 
;
´´ 
}
¨¨ 
}
≠≠ 	
public
∞∞ 
async
∞∞ 
Task
∞∞ 
<
∞∞ 
bool
∞∞ 
>
∞∞ 
UpdateOneAsync
∞∞  .
(
∞∞. /
TEntity
∞∞/ 6
entity
∞∞7 =
)
∞∞= >
{
±± 	
await
≤≤ 
Task
≤≤ 
.
≤≤ 
CompletedTask
≤≤ $
;
≤≤$ %
try
≥≥ 
{
¥¥ 
_context
µµ 
.
µµ 
Update
µµ 
(
µµ  
entity
µµ  &
)
µµ& '
;
µµ' (
await
∂∂ 
_context
∂∂ 
.
∂∂ 
SaveChangesAsync
∂∂ /
(
∂∂/ 0
true
∂∂0 4
)
∂∂4 5
;
∂∂5 6
return
∑∑ 
true
∑∑ 
;
∑∑ 
}
∏∏ 
catch
ππ 
(
ππ 
	Exception
ππ 
ex
ππ 
)
ππ  
{
∫∫ 
return
ªª 
false
ªª 
;
ªª 
}
ºº 
}
ΩΩ 	
public
øø 
async
øø 
Task
øø 
<
øø 
Pagging
øø !
<
øø! "
TEntity
øø" )
>
øø) *
>
øø* +
GetPaggingAsync
øø, ;
(
øø; <

Pagination
øø< F

pagination
øøG Q
,
øøQ R
Func
øøS W
<
øøW X
TEntity
øøX _
,
øø_ `
bool
øøa e
>
øøe f
	predicate
øøg p
=
øøq r
null
øøs w
)
øøw x
{
¿¿ 	
try
¡¡ 
{
¬¬ 
var
√√ 
skip
√√ 
=
√√ 
(
√√ 

pagination
√√ &
.
√√& '
	PageIndex
√√' 0
-
√√1 2
$num
√√3 4
)
√√4 5
*
√√6 7

pagination
√√8 B
.
√√B C
PageSize
√√C K
;
√√K L
var
ƒƒ 
take
ƒƒ 
=
ƒƒ 

pagination
ƒƒ %
.
ƒƒ% &
PageSize
ƒƒ& .
;
ƒƒ. /
var
≈≈ 
entities
≈≈ 
=
≈≈ 
await
≈≈ $
_context
≈≈% -
.
≈≈- .
Set
≈≈. 1
<
≈≈1 2
TEntity
≈≈2 9
>
≈≈9 :
(
≈≈: ;
)
≈≈; <
.
≈≈< =
Skip
≈≈= A
(
≈≈A B
skip
≈≈B F
)
≈≈F G
.
≈≈G H
Take
≈≈H L
(
≈≈L M
take
≈≈M Q
)
≈≈Q R
.
≈≈R S
ToListAsync
≈≈S ^
(
≈≈^ _
)
≈≈_ `
;
≈≈` a
if
∆∆ 
(
∆∆ 
!
∆∆ 

pagination
∆∆ 
.
∆∆  
OrderBy
∆∆  '
.
∆∆' ('
IsNullOrEmptyOrWhiteSpace
∆∆( A
(
∆∆A B
)
∆∆B C
)
∆∆C D
{
«« 
if
»» 
(
»» 

pagination
»» "
.
»»" #
SortType
»»# +
==
»», .
SortType
»»/ 7
.
»»7 8
DESC
»»8 <
)
»»< =
{
…… 
entities
    
=
  ! "
entities
  # +
.
  + ,
AsQueryable
  , 7
(
  7 8
)
  8 9
.
  9 :%
OrderByDescendingCustom
  : Q
(
  Q R

pagination
  R \
.
  \ ]
OrderBy
  ] d
)
  d e
.
  e f
ToList
  f l
(
  l m
)
  m n
;
  n o
}
ÀÀ 
else
ÃÃ 
{
ÕÕ 
entities
ŒŒ  
=
ŒŒ! "
entities
ŒŒ# +
.
ŒŒ+ ,
AsQueryable
ŒŒ, 7
(
ŒŒ7 8
)
ŒŒ8 9
.
ŒŒ9 :
OrderByCustom
ŒŒ: G
(
ŒŒG H

pagination
ŒŒH R
.
ŒŒR S
OrderBy
ŒŒS Z
)
ŒŒZ [
.
ŒŒ[ \
ToList
ŒŒ\ b
(
ŒŒb c
)
ŒŒc d
;
ŒŒd e
}
œœ 
}
–– 
if
—— 
(
—— 
	predicate
—— 
!=
——  
null
——! %
)
——% &
{
““ 
entities
”” 
=
”” 
entities
”” '
.
””' (
Where
””( -
(
””- .
	predicate
””. 7
)
””7 8
.
””8 9
ToList
””9 ?
(
””? @
)
””@ A
;
””A B
}
‘‘ 
var
÷÷ 

pageResult
÷÷ 
=
÷÷  
new
÷÷! $
Pagging
÷÷% ,
<
÷÷, -
TEntity
÷÷- 4
>
÷÷4 5
(
÷÷5 6
)
÷÷6 7
{
÷÷8 9
	PageIndex
÷÷: C
=
÷÷D E

pagination
÷÷F P
.
÷÷P Q
	PageIndex
÷÷Q Z
,
÷÷Z [
PageSize
÷÷\ d
=
÷÷e f

pagination
÷÷g q
.
÷÷q r
PageSize
÷÷r z
}
÷÷{ |
;
÷÷| }
if
◊◊ 
(
◊◊ 
entities
◊◊ 
==
◊◊ 
null
◊◊  $
||
◊◊% '
entities
◊◊( 0
.
◊◊0 1
Count
◊◊1 6
<=
◊◊7 9
$num
◊◊: ;
)
◊◊; <
return
◊◊= C

pageResult
◊◊D N
;
◊◊N O
long
⁄⁄ 

totalCount
⁄⁄ 
=
⁄⁄  !
$num
⁄⁄" #
;
⁄⁄# $
if
€€ 
(
€€ 
	predicate
€€ 
!=
€€  
null
€€! %
)
€€% &
{
‹‹ 

totalCount
›› 
=
››  
await
››! &
GetCountEntity
››' 5
(
››5 6
	predicate
››6 ?
)
››? @
;
››@ A
}
ﬁﬁ 
else
ﬂﬂ 
{
‡‡ 

totalCount
·· 
=
··  
await
··! &
GetCountEntity
··' 5
(
··5 6
)
··6 7
;
··7 8
}
‚‚ 

pageResult
‰‰ 
.
‰‰ 
Data
‰‰ 
=
‰‰  !
entities
‰‰" *
;
‰‰* +

pageResult
ÂÂ 
.
ÂÂ 
TotalRecord
ÂÂ &
=
ÂÂ' (

totalCount
ÂÂ) 3
;
ÂÂ3 4

pageResult
ÊÊ 
.
ÊÊ 

TotalPages
ÊÊ %
=
ÊÊ& '

totalCount
ÊÊ( 2
%
ÊÊ3 4

pagination
ÊÊ5 ?
.
ÊÊ? @
PageSize
ÊÊ@ H
==
ÊÊI K
$num
ÊÊL M
?
ÊÊN O

totalCount
ÊÊP Z
/
ÊÊ[ \

pagination
ÊÊ] g
.
ÊÊg h
PageSize
ÊÊh p
:
ÊÊq r

totalCount
ÊÊs }
/
ÊÊ~ 

paginationÊÊÄ ä
.ÊÊä ã
PageSizeÊÊã ì
+ÊÊî ï
$numÊÊñ ó
;ÊÊó ò
return
ÁÁ 

pageResult
ÁÁ !
;
ÁÁ! "
}
ËË 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÍÍ 
return
ÎÎ 
new
ÎÎ 
Pagging
ÎÎ "
<
ÎÎ" #
TEntity
ÎÎ# *
>
ÎÎ* +
(
ÎÎ+ ,
)
ÎÎ, -
;
ÎÎ- .
}
ÏÏ 
}
ÌÌ 	
public
ÔÔ 
async
ÔÔ 
Task
ÔÔ 
<
ÔÔ 
long
ÔÔ 
>
ÔÔ 
GetCountEntity
ÔÔ  .
(
ÔÔ. /
Func
ÔÔ/ 3
<
ÔÔ3 4
TEntity
ÔÔ4 ;
,
ÔÔ; <
bool
ÔÔ= A
>
ÔÔA B
	predicate
ÔÔC L
=
ÔÔM N
null
ÔÔO S
)
ÔÔS T
{
 	
var
ÒÒ 
entities
ÒÒ 
=
ÒÒ 
await
ÒÒ  
_context
ÒÒ! )
.
ÒÒ) *
Set
ÒÒ* -
<
ÒÒ- .
TEntity
ÒÒ. 5
>
ÒÒ5 6
(
ÒÒ6 7
)
ÒÒ7 8
.
ÒÒ8 9
ToListAsync
ÒÒ9 D
(
ÒÒD E
)
ÒÒE F
;
ÒÒF G
if
ÚÚ 
(
ÚÚ 
	predicate
ÚÚ 
!=
ÚÚ 
null
ÚÚ !
)
ÚÚ! "
{
ÛÛ 
entities
ÙÙ 
=
ÙÙ 
entities
ÙÙ #
.
ÙÙ# $
Where
ÙÙ$ )
(
ÙÙ) *
	predicate
ÙÙ* 3
)
ÙÙ3 4
.
ÙÙ4 5
ToList
ÙÙ5 ;
(
ÙÙ; <
)
ÙÙ< =
;
ÙÙ= >
}
ıı 
return
ˆˆ 
entities
ˆˆ 
.
ˆˆ 
Count
ˆˆ !
(
ˆˆ! "
)
ˆˆ" #
;
ˆˆ# $
}
˜˜ 	
public
˛˛ 
async
˛˛ 
Task
˛˛ 
<
˛˛ 
IEnumerable
˛˛ %
<
˛˛% &
TEntity
˛˛& -
>
˛˛- .
>
˛˛. /
GetAllAsync
˛˛0 ;
(
˛˛; <
Func
˛˛< @
<
˛˛@ A
TEntity
˛˛A H
,
˛˛H I
bool
˛˛J N
>
˛˛N O
	predicate
˛˛P Y
)
˛˛Y Z
{
ˇˇ 	
var
ÄÄ 
entities
ÄÄ 
=
ÄÄ 
await
ÄÄ  
_context
ÄÄ! )
.
ÄÄ) *
Set
ÄÄ* -
<
ÄÄ- .
TEntity
ÄÄ. 5
>
ÄÄ5 6
(
ÄÄ6 7
)
ÄÄ7 8
.
ÄÄ8 9
ToListAsync
ÄÄ9 D
(
ÄÄD E
)
ÄÄE F
;
ÄÄF G
entities
ÅÅ 
=
ÅÅ 
entities
ÅÅ 
.
ÅÅ  
Where
ÅÅ  %
(
ÅÅ% &
	predicate
ÅÅ& /
)
ÅÅ/ 0
.
ÅÅ0 1
ToList
ÅÅ1 7
(
ÅÅ7 8
)
ÅÅ8 9
;
ÅÅ9 :
return
ÇÇ 
entities
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
public
ÖÖ 
async
ÖÖ 
Task
ÖÖ 
<
ÖÖ 
TEntity
ÖÖ !
>
ÖÖ! "
GetOneAsync
ÖÖ# .
(
ÖÖ. /
Func
ÖÖ/ 3
<
ÖÖ3 4
TEntity
ÖÖ4 ;
,
ÖÖ; <
bool
ÖÖ= A
>
ÖÖA B
	predicate
ÖÖC L
)
ÖÖL M
{
ÜÜ 	
var
áá 
entities
áá 
=
áá 
await
áá  
_context
áá! )
.
áá) *
Set
áá* -
<
áá- .
TEntity
áá. 5
>
áá5 6
(
áá6 7
)
áá7 8
.
áá8 9
ToListAsync
áá9 D
(
ááD E
)
ááE F
;
ááF G
var
àà 
entity
àà 
=
àà 
entities
àà !
.
àà! "
FirstOrDefault
àà" 0
(
àà0 1
	predicate
àà1 :
)
àà: ;
;
àà; <
return
ââ 
entity
ââ 
;
ââ 
}
ää 	
}
ãã 
}åå Ú%
XC:\Users\hienv\OneDrive\Desktop\NVHIEN\DoAnTotNghiep\Backend\PostgresDBData\IBaseRepo.cs
	namespace 	
PostgresDBData
 
{		 
public

 

	interface

 
	IBaseRepo

 
<

 
TEntity

 &
>

& '
where

( -
TEntity

. 5
:

6 7
class

8 =
{ 
Task 
< 
long 
> 
GetCountEntity !
(! "
Func" &
<& '
TEntity' .
,. /
bool0 4
>4 5
	predicate6 ?
=@ A
nullB F
)F G
;G H
IEnumerable 
< 
TEntity 
> 
GetAll "
(" #
)# $
;$ %
Task 
< 
IEnumerable 
< 
TEntity  
>  !
>! "
GetAllAsync# .
(. /
)/ 0
;0 1
Task 
< 
IEnumerable 
< 
TEntity  
>  !
>! "
GetAllAsync# .
(. /
Func/ 3
<3 4
TEntity4 ;
,; <
bool< @
>@ A
	predicateB K
)K L
;L M
Task 
< 
TEntity 
> 
GetOneAsync !
(! "
Func" &
<& '
TEntity' .
,. /
bool/ 3
>3 4
	predicate5 >
)> ?
;? @
Task 
< 
Pagging 
< 
TEntity 
> 
> 
GetPaggingAsync .
(. /

Pagination/ 9

pagination: D
,D E
FuncF J
<J K
TEntityK R
,R S
boolT X
>X Y
	predicateZ c
=d e
nullf j
)j k
;k l
Task 
< 
IEnumerable 
< 
TEntity  
>  !
>! "
GetByIdsAsync# 0
(0 1
IEnumerable1 <
<< =
string= C
>C D
idsE H
)H I
;I J
TEntity 
GetById 
( 
string 
id !
)! "
;" #
Task 
< 
TEntity 
> 
GetByIdAsync !
(! "
string" (
id) +
)+ ,
;, -
Task 
< 
bool 
> 
UpdateOneAsync !
(! "
TEntity" )
entity* 0
)0 1
;1 2
Task 
< 
bool 
> 
UpdateManyAsync "
(" #
IEnumerable# .
<. /
TEntity/ 6
>6 7
entities8 @
)@ A
;A B
Task## 
<## 
TEntity## 
>## 
InsertOneAsync## $
(##$ %
TEntity##% ,
entity##- 3
)##3 4
;##4 5
Task$$ 
<$$ 
IEnumerable$$ 
<$$ 
TEntity$$  
>$$  !
>$$! "
InsertManyAsync$$# 2
($$2 3
IEnumerable$$3 >
<$$> ?
TEntity$$? F
>$$F G
entity$$G M
)$$M N
;$$N O
Task(( 
<(( 
bool(( 
>(( 
DeleteOneAsync(( !
(((! "
TEntity((" )
entity((* 0
)((0 1
;((1 2
Task)) 
<)) 
bool)) 
>)) 
DeleteOneAsync)) !
())! "
Func))" &
<))& '
TEntity))' .
,)). /
bool))0 4
>))4 5
	predicate))6 ?
)))? @
;))@ A
Task** 
<** 
bool** 
>** 
DeleteOneAsync** !
(**! "
string**" (
id**) +
)**+ ,
;**, -
Task++ 
<++ 
bool++ 
>++ 
DeleteManyAsync++ "
(++" #
IEnumerable++# .
<++. /
TEntity++/ 6
>++6 7
entity++7 =
)++= >
;++> ?
Task,, 
<,, 
bool,, 
>,, 
DeleteManyAsync,, "
(,," #
Func,,# '
<,,' (
TEntity,,( /
,,,/ 0
bool,,1 5
>,,5 6
	predicate,,7 @
),,@ A
;,,A B
Task-- 
<-- 
bool-- 
>-- 
DeleteManyAsync-- "
(--" #
IEnumerable--# .
<--. /
string--/ 5
>--5 6
ids--7 :
)--: ;
;--; <
}// 
}00 Ò:
`C:\Users\hienv\OneDrive\Desktop\NVHIEN\DoAnTotNghiep\Backend\PostgresDBData\PostgresDBContext.cs
	namespace 	
PostgresDBData
 
{		 
public

 

class

 
PostgreSqlContext

 "
:

# $
	DbContext

% .
{ 
private 
readonly 
PostgresSettings )
_postgresSettings* ;
;; <
public 
PostgreSqlContext  
(  !
DbContextOptions! 1
<1 2
PostgreSqlContext2 C
>C D
optionsE L
)L M
:N O
baseP T
(T U
optionsU \
)\ ]
{ 	
} 	
public 
DbSet 
< 
User 
> 
users  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
AddressInfo  
>  !
address_infos" /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public 
DbSet 
< 
Comment 
> 
comments &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 

Permission 
>  
permissions! ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
DbSet 
< 
PermissionDetail %
>% &
permission_details' 9
{: ;
get< ?
;? @
setA D
;D E
}F G
public 
DbSet 
< "
PermissionRelationship +
>+ ,$
permission_relationships- E
{F G
getH K
;K L
setM P
;P Q
}R S
public 
DbSet 
< 
Feedback 
> 
	feedbacks (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
DbSet 
< 
Product 
> 
products &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
ProductCategory $
>$ %
product_categories& 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
DbSet 
< 
Color 
> 
colors "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DbSet 
< 
Order 
> 
orders "
{# $
get% (
;( )
set* -
;- .
}/ 0
public   
DbSet   
<   
	OrderItem   
>   
order_items    +
{  , -
get  . 1
;  1 2
set  3 6
;  6 7
}  8 9
public!! 
DbSet!! 
<!! 
BlogCategory!! !
>!!! "
blog_categories!!# 2
{!!3 4
get!!5 8
;!!8 9
set!!: =
;!!= >
}!!? @
public"" 
DbSet"" 
<"" 
Blog"" 
>"" 
blogs""  
{""! "
get""# &
;""& '
set""( +
;""+ ,
}""- .
public## 
DbSet## 
<## 
Image## 
>## 
images## "
{### $
get##% (
;##( )
set##* -
;##- .
}##/ 0
	protected&& 
override&& 
void&& 
OnModelCreating&&  /
(&&/ 0
ModelBuilder&&0 <
modelBuilder&&= I
)&&I J
{'' 	
base44 
.44 
OnModelCreating44  
(44  !
modelBuilder44! -
)44- .
;44. /
}55 	
public66 
override66 
int66 
SaveChanges66 '
(66' (
)66( )
{77 	
ChangeTracker88 
.88 
DetectChanges88 '
(88' (
)88( )
;88) *
return99 
base99 
.99 
SaveChanges99 #
(99# $
)99$ %
;99% &
}:: 	
public<< 
override<< 
Task<< 
<<< 
int<<  
><<  !
SaveChangesAsync<<" 2
(<<2 3
bool<<3 7%
acceptAllChangesOnSuccess<<8 Q
=<<R S
true<<T X
,<<X Y
CancellationToken<<Z k
cancellationToken<<l }
=<<~ 
default
<<Ä á
(
<<á à
CancellationToken
<<à ô
)
<<ô ö
)
<<ö õ
{== 	
var>> 
entries>> 
=>> 
ChangeTracker>> '
.>>' (
Entries>>( /
(>>/ 0
)>>0 1
.>>1 2
Where>>2 7
(>>7 8
E>>8 9
=>>>: <
E>>= >
.>>> ?
State>>? D
==>>E G
EntityState>>H S
.>>S T
Added>>T Y
||>>Z \
E>>] ^
.>>^ _
State>>_ d
==>>e g
EntityState>>h s
.>>s t
Modified>>t |
)>>| }
.>>} ~
ToList	>>~ Ñ
(
>>Ñ Ö
)
>>Ö Ü
;
>>Ü á
foreach@@ 
(@@ 
var@@ 
entityEntry@@ $
in@@% '
entries@@( /
)@@/ 0
{AA 
ifBB 
(BB 
entityEntryBB 
.BB  
StateBB  %
==BB& (
EntityStateBB) 4
.BB4 5
ModifiedBB5 =
)BB= >
{CC 
entityEntryDD 
.DD  
PropertyDD  (
(DD( )
$strDD) 8
)DD8 9
.DD9 :
CurrentValueDD: F
=DDG H
DateTimeDDI Q
.DDQ R
UtcNowDDR X
;DDX Y
}EE 
elseFF 
ifFF 
(FF 
entityEntryFF $
.FF$ %
StateFF% *
==FF+ -
EntityStateFF. 9
.FF9 :
AddedFF: ?
)FF? @
{GG 
entityEntryHH 
.HH  
PropertyHH  (
(HH( )
$strHH) -
)HH- .
.HH. /
CurrentValueHH/ ;
=HH< =
$"HH> @
{HH@ A
GuidHHA E
.HHE F
NewGuidHHF M
(HHM N
)HHN O
}HHO P
"HHP Q
;HHQ R
entityEntryII 
.II  
PropertyII  (
(II( )
$strII) 7
)II7 8
.II8 9
CurrentValueII9 E
=IIF G
DateTimeIIH P
.IIP Q
NowIIQ T
;IIT U
entityEntryJJ 
.JJ  
PropertyJJ  (
(JJ( )
$strJJ) 8
)JJ8 9
.JJ9 :
CurrentValueJJ: F
=JJG H
DateTimeJJI Q
.JJQ R
NowJJR U
;JJU V
}KK 
}LL 
returnNN 
baseNN 
.NN 
SaveChangesAsyncNN (
(NN( )%
acceptAllChangesOnSuccessNN) B
,NNB C
cancellationTokenNND U
)NNU V
;NNV W
}OO 	
}PP 
}QQ ú
_C:\Users\hienv\OneDrive\Desktop\NVHIEN\DoAnTotNghiep\Backend\PostgresDBData\PostgresSettings.cs
	namespace 	
PostgresDBData
 
{ 
public		 

class		 
PostgresSettings		 !
{

 
public 
const 
string 
CONFIG_NAME '
=( )
$str* <
;< =
public 
const 
string 
ConnectionString ,
=- .
$str/ z
;z {
} 
} 