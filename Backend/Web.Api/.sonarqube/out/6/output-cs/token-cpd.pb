чк
WC:\Users\hienv\OneDrive\Desktop\NVHIEN\DoAnTotNghiep\Backend\PostgresDBData\BaseRepo.cs
	namespace 	
PostgresDBData
 
{ 
public 

class 
BaseRepo 
< 
TEntity !
>! "
:# $
	IBaseRepo% .
<. /
TEntity/ 6
>6 7
where8 =
TEntity> E
:F G
classH M
{ 
	protected 
readonly 
PostgreSqlContext ,
_context- 5
;5 6
public 
DbSet 
< 
TEntity 
> 
entities &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
BaseRepo 
( 
) 
{ 	
var 
contextOptions 
=  
new! $#
DbContextOptionsBuilder% <
<< =
PostgreSqlContext= N
>N O
(O P
)P Q
. 
	UseNpgsql 
( 
@$" 
{ 
PostgresSettings /
./ 0
ConnectionString0 @
}@ A
"A B
)B C
. 
Options 
; 
_context 
= 
new 
PostgreSqlContext ,
(, -
contextOptions- ;
); <
;< =
} 	
public 
async 
Task 
< 
bool 
> 
DeleteManyAsync  /
(/ 0
IEnumerable0 ;
<; <
TEntity< C
>C D
entitiesE M
)M N
{ 	
await 
Task 
. 
CompletedTask $
;$ %
if 
( 
entities 
== 
null  
||! #
entities$ ,
., -
Count- 2
(2 3
)3 4
<=5 7
$num8 9
)9 :
return; A
falseB G
;G H
try 
{ 
_context 
. 
RemoveRange $
($ %
entities% -
)- .
;. /
await   
_context   
.   
SaveChangesAsync   /
(  / 0
true  0 4
)  4 5
;  5 6
return!! 
true!! 
;!! 
}"" 
catch## 
(## 
	Exception## 
)## 
{$$ 
return%% 
false%% 
;%% 
}&& 
}'' 	
public)) 
async)) 
Task)) 
<)) 
bool)) 
>)) 
DeleteManyAsync))  /
())/ 0
IEnumerable))0 ;
<)); <
string))< B
>))B C
ids))D G
)))G H
{** 	
if++ 
(++ 
ids++ 
==++ 
null++ 
||++ 
ids++ "
.++" #
Count++# (
(++( )
)++) *
<=+++ -
$num++. /
)++/ 0
return++1 7
false++8 =
;++= >
var,, 
entities,, 
=,, 
await,,  
GetByIdsAsync,,! .
(,,. /
ids,,/ 2
),,2 3
;,,3 4
if-- 
(-- 
entities-- 
==-- 
null--  
||--! #
entities--$ ,
.--, -
Count--- 2
(--2 3
)--3 4
<=--5 7
$num--8 9
)--9 :
return--; A
false--B G
;--G H
try.. 
{// 
_context00 
.00 
RemoveRange00 $
(00$ %
entities00% -
)00- .
;00. /
await11 
_context11 
.11 
SaveChangesAsync11 /
(11/ 0
true110 4
)114 5
;115 6
return22 
true22 
;22 
}33 
catch44 
(44 
	Exception44 
)44 
{55 
return66 
false66 
;66 
}77 
}88 	
public:: 
async:: 
Task:: 
<:: 
bool:: 
>:: 
DeleteManyAsync::  /
(::/ 0
Func::0 4
<::4 5
TEntity::5 <
,::< =
bool::> B
>::B C
	predicate::D M
)::M N
{;; 	
var<< 
entities<< 
=<< 
await<<  
GetAllAsync<<! ,
(<<, -
	predicate<<- 6
)<<6 7
;<<7 8
if== 
(== 
entities== 
==== 
null==  
||==! #
entities==$ ,
.==, -
Count==- 2
(==2 3
)==3 4
<===5 7
$num==8 9
)==9 :
return==; A
false==B G
;==G H
try>> 
{?? 
_context@@ 
.@@ 
RemoveRange@@ $
(@@$ %
entities@@% -
)@@- .
;@@. /
awaitAA 
_contextAA 
.AA 
SaveChangesAsyncAA /
(AA/ 0
trueAA0 4
)AA4 5
;AA5 6
returnBB 
trueBB 
;BB 
}CC 
catchDD 
(DD 
	ExceptionDD 
)DD 
{EE 
returnFF 
falseFF 
;FF 
}GG 
}HH 	
publicJJ 
asyncJJ 
TaskJJ 
<JJ 
boolJJ 
>JJ 
DeleteOneAsyncJJ  .
(JJ. /
TEntityJJ/ 6
entityJJ7 =
)JJ= >
{KK 	
awaitLL 
TaskLL 
.LL 
CompletedTaskLL $
;LL$ %
ifMM 
(MM 
entityMM 
==MM 
nullMM 
)MM 
returnMM  &
falseMM' ,
;MM, -
varNN 
resNN 
=NN 
_contextNN 
.NN 
RemoveNN %
<NN% &
TEntityNN& -
>NN- .
(NN. /
entityNN/ 5
)NN5 6
;NN6 7
awaitOO 
_contextOO 
.OO 
SaveChangesAsyncOO +
(OO+ ,
trueOO, 0
)OO0 1
;OO1 2
returnPP 
resPP 
!=PP 
nullPP 
;PP 
}QQ 	
publicSS 
asyncSS 
TaskSS 
<SS 
boolSS 
>SS 
DeleteOneAsyncSS  .
(SS. /
FuncSS/ 3
<SS3 4
TEntitySS4 ;
,SS; <
boolSS= A
>SSA B
	predicateSSC L
)SSL M
{TT 	
awaitUU 
TaskUU 
.UU 
CompletedTaskUU $
;UU$ %
varVV 
entityVV 
=VV 
awaitVV 
GetOneAsyncVV *
(VV* +
	predicateVV+ 4
)VV4 5
;VV5 6
ifWW 
(WW 
entityWW 
==WW 
nullWW 
)WW 
returnWW  &
falseWW' ,
;WW, -
varXX 
resXX 
=XX 
_contextXX 
.XX 
RemoveXX %
<XX% &
TEntityXX& -
>XX- .
(XX. /
entityXX/ 5
)XX5 6
;XX6 7
awaitYY 
_contextYY 
.YY 
SaveChangesAsyncYY +
(YY+ ,
trueYY, 0
)YY0 1
;YY1 2
returnZZ 
resZZ 
!=ZZ 
nullZZ 
;ZZ 
}[[ 	
public]] 
async]] 
Task]] 
<]] 
bool]] 
>]] 
DeleteOneAsync]]  .
(]]. /
string]]/ 5
id]]6 8
)]]8 9
{^^ 	
if__ 
(__ 
string__ 
.__ 
IsNullOrEmpty__ $
(__$ %
id__% '
)__' (
)__( )
return__* 0
false__1 6
;__6 7
var`` 
entity`` 
=`` 
await`` 
_context`` '
.``' (
Set``( +
<``+ ,
TEntity``, 3
>``3 4
(``4 5
)``5 6
.``6 7
	FindAsync``7 @
(``@ A
id``A C
)``C D
;``D E
ifaa 
(aa 
entityaa 
==aa 
nullaa 
)aa 
returnaa  &
falseaa' ,
;aa, -
varbb 
resbb 
=bb 
_contextbb 
.bb 
Removebb %
<bb% &
TEntitybb& -
>bb- .
(bb. /
entitybb/ 5
)bb5 6
;bb6 7
awaitcc 
_contextcc 
.cc 
SaveChangesAsynccc +
(cc+ ,
truecc, 0
)cc0 1
;cc1 2
returndd 
resdd 
!=dd 
nulldd 
;dd 
}ee 	
publicgg 
IEnumerablegg 
<gg 
TEntitygg "
>gg" #
GetAllgg$ *
(gg* +
)gg+ ,
{hh 	
varii 
entitiesii 
=ii 
_contextii #
.ii# $
Setii$ '
<ii' (
TEntityii( /
>ii/ 0
(ii0 1
)ii1 2
.ii2 3
ToListii3 9
(ii9 :
)ii: ;
;ii; <
returnjj 
entitiesjj 
;jj 
}kk 	
publicmm 
asyncmm 
Taskmm 
<mm 
IEnumerablemm %
<mm% &
TEntitymm& -
>mm- .
>mm. /
GetAllAsyncmm0 ;
(mm; <
)mm< =
{nn 	
varoo 
entitiesoo 
=oo 
awaitoo  
_contextoo! )
.oo) *
Setoo* -
<oo- .
TEntityoo. 5
>oo5 6
(oo6 7
)oo7 8
.oo8 9
ToListAsyncoo9 D
(ooD E
)ooE F
;ooF G
returnpp 
entitiespp 
;pp 
}qq 	
publicrr 
asyncrr 
Taskrr 
<rr 
IEnumerablerr %
<rr% &
TEntityrr& -
>rr- .
>rr. /
GetByIdsAsyncrr0 =
(rr= >
IEnumerablerr> I
<rrI J
stringrrJ P
>rrP Q
idsrrR U
)rrU V
{ss 	
vartt 
entitiestt 
=tt 
awaittt  
_contexttt! )
.tt) *
Settt* -
<tt- .
TEntitytt. 5
>tt5 6
(tt6 7
)tt7 8
.tt8 9
ToListAsynctt9 D
(ttD E
)ttE F
;ttF G
entitiesuu 
=uu 
entitiesuu 
.uu  
Whereuu  %
(uu% &
euu& '
=>uu( *
idsuu+ .
.uu. /
Anyuu/ 2
(uu2 3
xuu3 4
=>uu5 7
xuu8 9
.uu9 :
ToStringuu: B
(uuB C
)uuC D
.uuD E
EqualsuuE K
(uuK L
euuL M
.uuM N
ToStringuuN V
(uuV W
)uuW X
)uuX Y
)uuY Z
)uuZ [
.uu[ \
ToListuu\ b
(uub c
)uuc d
;uud e
returnvv 
entitiesvv 
;vv 
}ww 	
publicyy 
TEntityyy 
GetByIdyy 
(yy 
stringyy %
idyy& (
)yy( )
{zz 	
return{{ 
_context{{ 
.{{ 
Set{{ 
<{{  
TEntity{{  '
>{{' (
({{( )
){{) *
.{{* +
Find{{+ /
({{/ 0
id{{0 2
){{2 3
;{{3 4
}|| 	
public~~ 
async~~ 
Task~~ 
<~~ 
TEntity~~ !
>~~! "
GetByIdAsync~~# /
(~~/ 0
string~~0 6
id~~7 9
)~~9 :
{ 	
var
ђђ 
entity
ђђ 
=
ђђ 
await
ђђ 
_context
ђђ '
.
ђђ' (
Set
ђђ( +
<
ђђ+ ,
TEntity
ђђ, 3
>
ђђ3 4
(
ђђ4 5
)
ђђ5 6
.
ђђ6 7
	FindAsync
ђђ7 @
(
ђђ@ A
id
ђђA C
)
ђђC D
;
ђђD E
return
ЂЂ 
entity
ЂЂ 
;
ЂЂ 
}
ѓѓ 	
public
ёё 
async
ёё 
Task
ёё 
<
ёё 
IEnumerable
ёё %
<
ёё% &
TEntity
ёё& -
>
ёё- .
>
ёё. /
InsertManyAsync
ёё0 ?
(
ёё? @
IEnumerable
ёё@ K
<
ёёK L
TEntity
ёёL S
>
ёёS T
entities
ёёU ]
)
ёё] ^
{
ЁЁ 	
try
єє 
{
ЄЄ 
await
ѕѕ 
_context
ѕѕ 
.
ѕѕ 
AddRangeAsync
ѕѕ ,
(
ѕѕ, -
entities
ѕѕ- 5
)
ѕѕ5 6
;
ѕѕ6 7
await
ЅЅ 
_context
ЅЅ 
.
ЅЅ 
SaveChangesAsync
ЅЅ /
(
ЅЅ/ 0
true
ЅЅ0 4
)
ЅЅ4 5
;
ЅЅ5 6
return
іі 
entities
іі 
;
іі  
}
ІІ 
catch
її 
(
її 
	Exception
її 
ex
її 
)
її  
{
ЇЇ 
return
јј 
null
јј 
;
јј 
}
ЈЈ 
}
љљ 	
public
њњ 
async
њњ 
Task
њњ 
<
њњ 
TEntity
њњ !
>
њњ! "
InsertOneAsync
њњ# 1
(
њњ1 2
TEntity
њњ2 9
entity
њњ: @
)
њњ@ A
{
ЊЊ 	
try
ћћ 
{
ЋЋ 
await
ќќ 
_context
ќќ 
.
ќќ 
AddAsync
ќќ '
(
ќќ' (
entity
ќќ( .
)
ќќ. /
;
ќќ/ 0
await
ЌЌ 
_context
ЌЌ 
.
ЌЌ 
SaveChangesAsync
ЌЌ /
(
ЌЌ/ 0
true
ЌЌ0 4
)
ЌЌ4 5
;
ЌЌ5 6
return
ўў 
entity
ўў 
;
ўў 
}
ЎЎ 
catch
џџ 
(
џџ 
	Exception
џџ 
ex
џџ 
)
џџ  
{
ЏЏ 
return
юю 
null
юю 
;
юю 
}
ЮЮ 
}
ъъ 	
public
аа 
async
аа 
Task
аа 
<
аа 
bool
аа 
>
аа 
UpdateManyAsync
аа  /
(
аа/ 0
IEnumerable
аа0 ;
<
аа; <
TEntity
аа< C
>
ааC D
entities
ааE M
)
ааM N
{
АА 	
await
бб 
Task
бб 
.
бб 
CompletedTask
бб $
;
бб$ %
try
ББ 
{
цц 
_context
ЦЦ 
.
ЦЦ 
UpdateRange
ЦЦ $
(
ЦЦ$ %
entities
ЦЦ% -
)
ЦЦ- .
;
ЦЦ. /
await
дд 
_context
дд 
.
дд 
SaveChangesAsync
дд /
(
дд/ 0
true
дд0 4
)
дд4 5
;
дд5 6
return
ДД 
true
ДД 
;
ДД 
}
ее 
catch
ЕЕ 
(
ЕЕ 
	Exception
ЕЕ 
ex
ЕЕ 
)
ЕЕ  
{
фф 
return
ФФ 
false
ФФ 
;
ФФ 
}
гг 
}
ГГ 	
public
░░ 
async
░░ 
Task
░░ 
<
░░ 
bool
░░ 
>
░░ 
UpdateOneAsync
░░  .
(
░░. /
TEntity
░░/ 6
entity
░░7 =
)
░░= >
{
▒▒ 	
await
▓▓ 
Task
▓▓ 
.
▓▓ 
CompletedTask
▓▓ $
;
▓▓$ %
try
││ 
{
┤┤ 
_context
хх 
.
хх 
Update
хх 
(
хх  
entity
хх  &
)
хх& '
;
хх' (
await
ХХ 
_context
ХХ 
.
ХХ 
SaveChangesAsync
ХХ /
(
ХХ/ 0
true
ХХ0 4
)
ХХ4 5
;
ХХ5 6
return
ии 
true
ии 
;
ии 
}
ИИ 
catch
╣╣ 
(
╣╣ 
	Exception
╣╣ 
ex
╣╣ 
)
╣╣  
{
║║ 
return
╗╗ 
false
╗╗ 
;
╗╗ 
}
╝╝ 
}
йй 	
public
┐┐ 
async
┐┐ 
Task
┐┐ 
<
┐┐ 
Pagging
┐┐ !
<
┐┐! "
TEntity
┐┐" )
>
┐┐) *
>
┐┐* +
GetPaggingAsync
┐┐, ;
(
┐┐; <

Pagination
┐┐< F

pagination
┐┐G Q
,
┐┐Q R
Func
┐┐S W
<
┐┐W X
TEntity
┐┐X _
,
┐┐_ `
bool
┐┐a e
>
┐┐e f
	predicate
┐┐g p
=
┐┐q r
null
┐┐s w
)
┐┐w x
{
└└ 	
try
┴┴ 
{
┬┬ 
var
├├ 
skip
├├ 
=
├├ 
(
├├ 

pagination
├├ &
.
├├& '
	PageIndex
├├' 0
-
├├1 2
$num
├├3 4
)
├├4 5
*
├├6 7

pagination
├├8 B
.
├├B C
PageSize
├├C K
;
├├K L
var
── 
take
── 
=
── 

pagination
── %
.
──% &
PageSize
──& .
;
──. /
var
┼┼ 
entities
┼┼ 
=
┼┼ 
await
┼┼ $
_context
┼┼% -
.
┼┼- .
Set
┼┼. 1
<
┼┼1 2
TEntity
┼┼2 9
>
┼┼9 :
(
┼┼: ;
)
┼┼; <
.
┼┼< =
Skip
┼┼= A
(
┼┼A B
skip
┼┼B F
)
┼┼F G
.
┼┼G H
Take
┼┼H L
(
┼┼L M
take
┼┼M Q
)
┼┼Q R
.
┼┼R S
ToListAsync
┼┼S ^
(
┼┼^ _
)
┼┼_ `
;
┼┼` a
if
кк 
(
кк 
!
кк 

pagination
кк 
.
кк  
OrderBy
кк  '
.
кк' ('
IsNullOrEmptyOrWhiteSpace
кк( A
(
ккA B
)
ккB C
)
ккC D
{
КК 
if
╚╚ 
(
╚╚ 

pagination
╚╚ "
.
╚╚" #
SortType
╚╚# +
==
╚╚, .
SortType
╚╚/ 7
.
╚╚7 8
DESC
╚╚8 <
)
╚╚< =
{
╔╔ 
entities
╩╩  
=
╩╩! "
entities
╩╩# +
.
╩╩+ ,
AsQueryable
╩╩, 7
(
╩╩7 8
)
╩╩8 9
.
╩╩9 :%
OrderByDescendingCustom
╩╩: Q
(
╩╩Q R

pagination
╩╩R \
.
╩╩\ ]
OrderBy
╩╩] d
)
╩╩d e
.
╩╩e f
ToList
╩╩f l
(
╩╩l m
)
╩╩m n
;
╩╩n o
}
╦╦ 
else
╠╠ 
{
══ 
entities
╬╬  
=
╬╬! "
entities
╬╬# +
.
╬╬+ ,
AsQueryable
╬╬, 7
(
╬╬7 8
)
╬╬8 9
.
╬╬9 :
OrderByCustom
╬╬: G
(
╬╬G H

pagination
╬╬H R
.
╬╬R S
OrderBy
╬╬S Z
)
╬╬Z [
.
╬╬[ \
ToList
╬╬\ b
(
╬╬b c
)
╬╬c d
;
╬╬d e
}
¤¤ 
}
лл 
if
ЛЛ 
(
ЛЛ 
	predicate
ЛЛ 
!=
ЛЛ  
null
ЛЛ! %
)
ЛЛ% &
{
мм 
entities
ММ 
=
ММ 
entities
ММ '
.
ММ' (
Where
ММ( -
(
ММ- .
	predicate
ММ. 7
)
ММ7 8
.
ММ8 9
ToList
ММ9 ?
(
ММ? @
)
ММ@ A
;
ММA B
}
нн 
var
оо 

pageResult
оо 
=
оо  
new
оо! $
Pagging
оо% ,
<
оо, -
TEntity
оо- 4
>
оо4 5
(
оо5 6
)
оо6 7
{
оо8 9
	PageIndex
оо: C
=
ооD E

pagination
ооF P
.
ооP Q
	PageIndex
ооQ Z
,
ооZ [
PageSize
оо\ d
=
ооe f

pagination
ооg q
.
ооq r
PageSize
ооr z
}
оо{ |
;
оо| }
if
ОО 
(
ОО 
entities
ОО 
==
ОО 
null
ОО  $
||
ОО% '
entities
ОО( 0
.
ОО0 1
Count
ОО1 6
<=
ОО7 9
$num
ОО: ;
)
ОО; <
return
ОО= C

pageResult
ООD N
;
ООN O
long
┌┌ 

totalCount
┌┌ 
=
┌┌  !
$num
┌┌" #
;
┌┌# $
if
██ 
(
██ 
	predicate
██ 
!=
██  
null
██! %
)
██% &
{
▄▄ 

totalCount
ПП 
=
ПП  
await
ПП! &
GetCountEntity
ПП' 5
(
ПП5 6
	predicate
ПП6 ?
)
ПП? @
;
ПП@ A
}
яя 
else
▀▀ 
{
ЯЯ 

totalCount
рр 
=
рр  
await
рр! &
GetCountEntity
рр' 5
(
рр5 6
)
рр6 7
;
рр7 8
}
РР 

pageResult
СС 
.
СС 
Data
СС 
=
СС  !
entities
СС" *
;
СС* +

pageResult
тт 
.
тт 
TotalRecord
тт &
=
тт' (

totalCount
тт) 3
;
тт3 4

pageResult
ТТ 
.
ТТ 

TotalPages
ТТ %
=
ТТ& '

totalCount
ТТ( 2
%
ТТ3 4

pagination
ТТ5 ?
.
ТТ? @
PageSize
ТТ@ H
==
ТТI K
$num
ТТL M
?
ТТN O

totalCount
ТТP Z
/
ТТ[ \

pagination
ТТ] g
.
ТТg h
PageSize
ТТh p
:
ТТq r

totalCount
ТТs }
/
ТТ~ 

paginationТТђ і
.ТТі І
PageSizeТТІ Њ
+ТТћ Ћ
$numТТќ Ќ
;ТТЌ ў
return
уу 

pageResult
уу !
;
уу! "
}
УУ 
catch
жж 
(
жж 
	Exception
жж 
ex
жж 
)
жж  
{
ЖЖ 
return
вв 
new
вв 
Pagging
вв "
<
вв" #
TEntity
вв# *
>
вв* +
(
вв+ ,
)
вв, -
;
вв- .
}
ВВ 
}
ьь 	
public
№№ 
async
№№ 
Task
№№ 
<
№№ 
long
№№ 
>
№№ 
GetCountEntity
№№  .
(
№№. /
Func
№№/ 3
<
№№3 4
TEntity
№№4 ;
,
№№; <
bool
№№= A
>
№№A B
	predicate
№№C L
=
№№M N
null
№№O S
)
№№S T
{
­­ 	
var
ыы 
entities
ыы 
=
ыы 
await
ыы  
_context
ыы! )
.
ыы) *
Set
ыы* -
<
ыы- .
TEntity
ыы. 5
>
ыы5 6
(
ыы6 7
)
ыы7 8
.
ыы8 9
ToListAsync
ыы9 D
(
ыыD E
)
ыыE F
;
ыыF G
if
ЫЫ 
(
ЫЫ 
	predicate
ЫЫ 
!=
ЫЫ 
null
ЫЫ !
)
ЫЫ! "
{
зз 
entities
ЗЗ 
=
ЗЗ 
entities
ЗЗ #
.
ЗЗ# $
Where
ЗЗ$ )
(
ЗЗ) *
	predicate
ЗЗ* 3
)
ЗЗ3 4
.
ЗЗ4 5
ToList
ЗЗ5 ;
(
ЗЗ; <
)
ЗЗ< =
;
ЗЗ= >
}
шш 
return
ШШ 
entities
ШШ 
.
ШШ 
Count
ШШ !
(
ШШ! "
)
ШШ" #
;
ШШ# $
}
ээ 	
public
■■ 
async
■■ 
Task
■■ 
<
■■ 
IEnumerable
■■ %
<
■■% &
TEntity
■■& -
>
■■- .
>
■■. /
GetAllAsync
■■0 ;
(
■■; <
Func
■■< @
<
■■@ A
TEntity
■■A H
,
■■H I
bool
■■J N
>
■■N O
	predicate
■■P Y
)
■■Y Z
{
   	
var
ђђ 
entities
ђђ 
=
ђђ 
await
ђђ  
_context
ђђ! )
.
ђђ) *
Set
ђђ* -
<
ђђ- .
TEntity
ђђ. 5
>
ђђ5 6
(
ђђ6 7
)
ђђ7 8
.
ђђ8 9
ToListAsync
ђђ9 D
(
ђђD E
)
ђђE F
;
ђђF G
entities
ЂЂ 
=
ЂЂ 
entities
ЂЂ 
.
ЂЂ  
Where
ЂЂ  %
(
ЂЂ% &
	predicate
ЂЂ& /
)
ЂЂ/ 0
.
ЂЂ0 1
ToList
ЂЂ1 7
(
ЂЂ7 8
)
ЂЂ8 9
;
ЂЂ9 :
return
ѓѓ 
entities
ѓѓ 
;
ѓѓ 
}
ЃЃ 	
public
ЁЁ 
async
ЁЁ 
Task
ЁЁ 
<
ЁЁ 
TEntity
ЁЁ !
>
ЁЁ! "
GetOneAsync
ЁЁ# .
(
ЁЁ. /
Func
ЁЁ/ 3
<
ЁЁ3 4
TEntity
ЁЁ4 ;
,
ЁЁ; <
bool
ЁЁ= A
>
ЁЁA B
	predicate
ЁЁC L
)
ЁЁL M
{
єє 	
var
ЄЄ 
entities
ЄЄ 
=
ЄЄ 
await
ЄЄ  
_context
ЄЄ! )
.
ЄЄ) *
Set
ЄЄ* -
<
ЄЄ- .
TEntity
ЄЄ. 5
>
ЄЄ5 6
(
ЄЄ6 7
)
ЄЄ7 8
.
ЄЄ8 9
ToListAsync
ЄЄ9 D
(
ЄЄD E
)
ЄЄE F
;
ЄЄF G
var
ѕѕ 
entity
ѕѕ 
=
ѕѕ 
entities
ѕѕ !
.
ѕѕ! "
FirstOrDefault
ѕѕ" 0
(
ѕѕ0 1
	predicate
ѕѕ1 :
)
ѕѕ: ;
;
ѕѕ; <
return
ЅЅ 
entity
ЅЅ 
;
ЅЅ 
}
іі 	
}
ІІ 
}її Ы%
XC:\Users\hienv\OneDrive\Desktop\NVHIEN\DoAnTotNghiep\Backend\PostgresDBData\IBaseRepo.cs
	namespace 	
PostgresDBData
 
{		 
public

 

	interface

 
	IBaseRepo

 
<

 
TEntity

 &
>

& '
where

( -
TEntity

. 5
:

6 7
class

8 =
{ 
Task 
< 
long 
> 
GetCountEntity !
(! "
Func" &
<& '
TEntity' .
,. /
bool0 4
>4 5
	predicate6 ?
=@ A
nullB F
)F G
;G H
IEnumerable 
< 
TEntity 
> 
GetAll "
(" #
)# $
;$ %
Task 
< 
IEnumerable 
< 
TEntity  
>  !
>! "
GetAllAsync# .
(. /
)/ 0
;0 1
Task 
< 
IEnumerable 
< 
TEntity  
>  !
>! "
GetAllAsync# .
(. /
Func/ 3
<3 4
TEntity4 ;
,; <
bool< @
>@ A
	predicateB K
)K L
;L M
Task 
< 
TEntity 
> 
GetOneAsync !
(! "
Func" &
<& '
TEntity' .
,. /
bool/ 3
>3 4
	predicate5 >
)> ?
;? @
Task 
< 
Pagging 
< 
TEntity 
> 
> 
GetPaggingAsync .
(. /

Pagination/ 9

pagination: D
,D E
FuncF J
<J K
TEntityK R
,R S
boolT X
>X Y
	predicateZ c
=d e
nullf j
)j k
;k l
Task 
< 
IEnumerable 
< 
TEntity  
>  !
>! "
GetByIdsAsync# 0
(0 1
IEnumerable1 <
<< =
string= C
>C D
idsE H
)H I
;I J
TEntity 
GetById 
( 
string 
id !
)! "
;" #
Task 
< 
TEntity 
> 
GetByIdAsync !
(! "
string" (
id) +
)+ ,
;, -
Task 
< 
bool 
> 
UpdateOneAsync !
(! "
TEntity" )
entity* 0
)0 1
;1 2
Task 
< 
bool 
> 
UpdateManyAsync "
(" #
IEnumerable# .
<. /
TEntity/ 6
>6 7
entities8 @
)@ A
;A B
Task## 
<## 
TEntity## 
>## 
InsertOneAsync## $
(##$ %
TEntity##% ,
entity##- 3
)##3 4
;##4 5
Task$$ 
<$$ 
IEnumerable$$ 
<$$ 
TEntity$$  
>$$  !
>$$! "
InsertManyAsync$$# 2
($$2 3
IEnumerable$$3 >
<$$> ?
TEntity$$? F
>$$F G
entity$$G M
)$$M N
;$$N O
Task(( 
<(( 
bool(( 
>(( 
DeleteOneAsync(( !
(((! "
TEntity((" )
entity((* 0
)((0 1
;((1 2
Task)) 
<)) 
bool)) 
>)) 
DeleteOneAsync)) !
())! "
Func))" &
<))& '
TEntity))' .
,)). /
bool))0 4
>))4 5
	predicate))6 ?
)))? @
;))@ A
Task** 
<** 
bool** 
>** 
DeleteOneAsync** !
(**! "
string**" (
id**) +
)**+ ,
;**, -
Task++ 
<++ 
bool++ 
>++ 
DeleteManyAsync++ "
(++" #
IEnumerable++# .
<++. /
TEntity++/ 6
>++6 7
entity++7 =
)++= >
;++> ?
Task,, 
<,, 
bool,, 
>,, 
DeleteManyAsync,, "
(,," #
Func,,# '
<,,' (
TEntity,,( /
,,,/ 0
bool,,1 5
>,,5 6
	predicate,,7 @
),,@ A
;,,A B
Task-- 
<-- 
bool-- 
>-- 
DeleteManyAsync-- "
(--" #
IEnumerable--# .
<--. /
string--/ 5
>--5 6
ids--7 :
)--: ;
;--; <
}// 
}00 ы:
`C:\Users\hienv\OneDrive\Desktop\NVHIEN\DoAnTotNghiep\Backend\PostgresDBData\PostgresDBContext.cs
	namespace 	
PostgresDBData
 
{		 
public

 

class

 
PostgreSqlContext

 "
:

# $
	DbContext

% .
{ 
private 
readonly 
PostgresSettings )
_postgresSettings* ;
;; <
public 
PostgreSqlContext  
(  !
DbContextOptions! 1
<1 2
PostgreSqlContext2 C
>C D
optionsE L
)L M
:N O
baseP T
(T U
optionsU \
)\ ]
{ 	
} 	
public 
DbSet 
< 
User 
> 
users  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
AddressInfo  
>  !
address_infos" /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public 
DbSet 
< 
Comment 
> 
comments &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 

Permission 
>  
permissions! ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
DbSet 
< 
PermissionDetail %
>% &
permission_details' 9
{: ;
get< ?
;? @
setA D
;D E
}F G
public 
DbSet 
< "
PermissionRelationship +
>+ ,$
permission_relationships- E
{F G
getH K
;K L
setM P
;P Q
}R S
public 
DbSet 
< 
Feedback 
> 
	feedbacks (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
DbSet 
< 
Product 
> 
products &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
ProductCategory $
>$ %
product_categories& 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
DbSet 
< 
Color 
> 
colors "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DbSet 
< 
Order 
> 
orders "
{# $
get% (
;( )
set* -
;- .
}/ 0
public   
DbSet   
<   
	OrderItem   
>   
order_items    +
{  , -
get  . 1
;  1 2
set  3 6
;  6 7
}  8 9
public!! 
DbSet!! 
<!! 
BlogCategory!! !
>!!! "
blog_categories!!# 2
{!!3 4
get!!5 8
;!!8 9
set!!: =
;!!= >
}!!? @
public"" 
DbSet"" 
<"" 
Blog"" 
>"" 
blogs""  
{""! "
get""# &
;""& '
set""( +
;""+ ,
}""- .
public## 
DbSet## 
<## 
Image## 
>## 
images## "
{### $
get##% (
;##( )
set##* -
;##- .
}##/ 0
	protected&& 
override&& 
void&& 
OnModelCreating&&  /
(&&/ 0
ModelBuilder&&0 <
modelBuilder&&= I
)&&I J
{'' 	
base44 
.44 
OnModelCreating44  
(44  !
modelBuilder44! -
)44- .
;44. /
}55 	
public66 
override66 
int66 
SaveChanges66 '
(66' (
)66( )
{77 	
ChangeTracker88 
.88 
DetectChanges88 '
(88' (
)88( )
;88) *
return99 
base99 
.99 
SaveChanges99 #
(99# $
)99$ %
;99% &
}:: 	
public<< 
override<< 
Task<< 
<<< 
int<<  
><<  !
SaveChangesAsync<<" 2
(<<2 3
bool<<3 7%
acceptAllChangesOnSuccess<<8 Q
=<<R S
true<<T X
,<<X Y
CancellationToken<<Z k
cancellationToken<<l }
=<<~ 
default
<<ђ Є
(
<<Є ѕ
CancellationToken
<<ѕ Ў
)
<<Ў џ
)
<<џ Џ
{== 	
var>> 
entries>> 
=>> 
ChangeTracker>> '
.>>' (
Entries>>( /
(>>/ 0
)>>0 1
.>>1 2
Where>>2 7
(>>7 8
E>>8 9
=>>>: <
E>>= >
.>>> ?
State>>? D
==>>E G
EntityState>>H S
.>>S T
Added>>T Y
||>>Z \
E>>] ^
.>>^ _
State>>_ d
==>>e g
EntityState>>h s
.>>s t
Modified>>t |
)>>| }
.>>} ~
ToList	>>~ ё
(
>>ё Ё
)
>>Ё є
;
>>є Є
foreach@@ 
(@@ 
var@@ 
entityEntry@@ $
in@@% '
entries@@( /
)@@/ 0
{AA 
ifBB 
(BB 
entityEntryBB 
.BB  
StateBB  %
==BB& (
EntityStateBB) 4
.BB4 5
ModifiedBB5 =
)BB= >
{CC 
entityEntryDD 
.DD  
PropertyDD  (
(DD( )
$strDD) 8
)DD8 9
.DD9 :
CurrentValueDD: F
=DDG H
DateTimeDDI Q
.DDQ R
UtcNowDDR X
;DDX Y
}EE 
elseFF 
ifFF 
(FF 
entityEntryFF $
.FF$ %
StateFF% *
==FF+ -
EntityStateFF. 9
.FF9 :
AddedFF: ?
)FF? @
{GG 
entityEntryHH 
.HH  
PropertyHH  (
(HH( )
$strHH) -
)HH- .
.HH. /
CurrentValueHH/ ;
=HH< =
$"HH> @
{HH@ A
GuidHHA E
.HHE F
NewGuidHHF M
(HHM N
)HHN O
}HHO P
"HHP Q
;HHQ R
entityEntryII 
.II  
PropertyII  (
(II( )
$strII) 7
)II7 8
.II8 9
CurrentValueII9 E
=IIF G
DateTimeIIH P
.IIP Q
NowIIQ T
;IIT U
entityEntryJJ 
.JJ  
PropertyJJ  (
(JJ( )
$strJJ) 8
)JJ8 9
.JJ9 :
CurrentValueJJ: F
=JJG H
DateTimeJJI Q
.JJQ R
NowJJR U
;JJU V
}KK 
}LL 
returnNN 
baseNN 
.NN 
SaveChangesAsyncNN (
(NN( )%
acceptAllChangesOnSuccessNN) B
,NNB C
cancellationTokenNND U
)NNU V
;NNV W
}OO 	
}PP 
}QQ ю
_C:\Users\hienv\OneDrive\Desktop\NVHIEN\DoAnTotNghiep\Backend\PostgresDBData\PostgresSettings.cs
	namespace 	
PostgresDBData
 
{ 
public		 

class		 
PostgresSettings		 !
{

 
public 
const 
string 
CONFIG_NAME '
=( )
$str* <
;< =
public 
const 
string 
ConnectionString ,
=- .
$str/ z
;z {
} 
} 